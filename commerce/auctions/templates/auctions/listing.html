{% extends "auctions/layout.html" %}

{% block body %}
<div class="container-fluid">
    <h2> Item: {{ listing.title }} </h2>
    <div>
        Seller: <a href="{% url 'userinfo' listing.seller.id %}">{{ listing.seller.username }}</a>
    </div>
    
    <div>
        Description: {{ listing.description }}
    </div>
    
    <div>
        {% if listing.image %}
        <img src="{{ listing.image }}" alt="{{ listing.title }}" class="img-thumbnail" width="500", height="500">
    
        {% else %}
            <h2>No image for this item</h2>
        {% endif %}
    </div>
    
    <div>
        {% if listing.current_price %}
        Current Price: ${{ listing.current_price }}
        {% else %}
        Starting price: ${{ listing.listing_start_price }}
        {% endif %}
    </div>

    <div>
        Current number of bids: {{ number_of_bids }}.
        {% if is_winning %}
        Congrats, you are currently the highest bidder!
        {% elif is_seller %}
        You are the seller.
        <a href="{% url 'editlisting' listing.id %}" class="btn btn-primary">Close/Edit your listing</a>
        {% elif listing.active == False %}
        The bidding has ended. The winner is {{ listing.current_bidder }}
        {% else %}
        <form action="{% url 'bidstatus' listing.id %}" method="post">
            {% csrf_token %}
            {{ bidding }}
            <input type="submit" class="btn btn-success">
        </form>
        {% endif %}

        {% if message %}
            {{ message }}
        {% endif %}
    </div>

    <div>
        <div class="mx-auto" style="width: 300px;">
            <h2>Comment Section</h2>
        </div>
            <a href="{% url 'addcomment' listing.id %}" class="btn btn-primary">Add a comment</a>

        <div class="d-grid gap-3">
            {% for comment in comments %}
            <div class="p-2 bg-light border">
                <a href="{% url 'userinfo' comment.commenter.id %}">{{ comment.commenter.username }}:</a>
                {{ comment.comment }}
            </div>
        {% empty %}
        </div>

        <h3>No comments yet.</h3>
        {% endfor %}
    </div>

</div>

{% endblock %}